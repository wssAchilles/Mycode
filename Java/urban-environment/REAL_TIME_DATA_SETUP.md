# 🌍 实时环境数据配置指南

## 概述
您的智慧城市环境监测平台现已集成真实的实时环境数据服务。本系统支持多个权威环境数据API，确保为您提供准确、实时的空气质量和天气数据。

## 🚀 快速开始

### 1. 无需配置（使用模拟数据）
如果您暂时不需要真实API数据，系统会自动使用高质量的模拟数据：
- ✅ 基于真实城市环境数据模式
- ✅ 时间相关的数据变化（早晚高峰、夜间等）
- ✅ 天气影响的数据波动
- ✅ 城市特征的基础数值
- ✅ 立即可用，无需任何配置

### 2. 使用真实API数据（推荐生产环境）

## 📡 支持的API服务

### 🌤️ 和风天气API（推荐）
**最佳选择 - 专为中国城市优化**

- 🌐 **网站**: https://dev.qweather.com/
- 💰 **价格**: 免费版每天1000次调用
- 🏙️ **覆盖范围**: 中国所有主要城市
- 📊 **数据类型**: 空气质量、天气、污染指数

**获取步骤**:
1. 访问 https://dev.qweather.com/
2. 注册账号
3. 创建应用
4. 获取API Key
5. 在项目中配置 `VITE_QWEATHER_API_KEY`

### 🌍 World Air Quality Index
**全球覆盖 - 国际标准**

- 🌐 **网站**: https://aqicn.org/api/
- 💰 **价格**: 免费版（demo token）有限制，付费版功能更全
- 🌏 **覆盖范围**: 全球主要城市
- 📊 **数据类型**: AQI、PM2.5、PM10、各种污染物

**获取步骤**:
1. 访问 https://aqicn.org/api/
2. 申请API Token
3. 配置 `VITE_WAQI_TOKEN`

### ☁️ OpenWeatherMap
**天气数据专家**

- 🌐 **网站**: https://openweathermap.org/api
- 💰 **价格**: 免费版每月1000次调用
- 🌍 **覆盖范围**: 全球
- 📊 **数据类型**: 天气、空气质量、污染物

## ⚙️ 配置方法

### 方法1: 环境变量配置（推荐）
在项目根目录创建 `.env` 文件：

\`\`\`bash
# 和风天气API
VITE_QWEATHER_API_KEY=your-qweather-api-key-here

# World Air Quality Index
VITE_WAQI_TOKEN=your-waqi-token-here

# OpenWeatherMap
VITE_OPENWEATHER_API_KEY=your-openweather-key-here
\`\`\`

### 方法2: 直接修改配置文件
编辑 `frontend/src/config/apiConfig.ts`:

\`\`\`typescript
export const API_CONFIG = {
  QWEATHER: {
    BASE_URL: 'https://devapi.qweather.com/v7',
    API_KEY: 'your-actual-api-key-here', // 替换为真实API密钥
  },
  // ... 其他配置
}
\`\`\`

## 📊 数据更新机制

### 自动更新
- 🔄 **初始加载**: 页面打开时立即获取最新数据
- ⏰ **定时刷新**: 每5分钟自动更新一次
- 🎯 **手动刷新**: 点击"🔄 刷新"按钮立即更新

### 数据降级策略
1. **优先使用**: 和风天气API（最适合中国城市）
2. **备选方案**: WAQI API（全球数据）
3. **降级方案**: 高质量模拟数据（确保系统始终可用）

## 🌟 数据特色

### 真实性保证
- 📡 **实时数据**: 直接从官方环保部门获取
- 🏙️ **多城市覆盖**: 覆盖全国20+主要城市
- 📈 **多维度数据**: PM2.5、PM10、温度、湿度、AQI等

### 智能处理
- 🧠 **时间感知**: 根据时间调整数据（早晚高峰、夜间等）
- 🌦️ **天气关联**: 考虑天气对空气质量的影响
- 🏭 **城市特色**: 基于不同城市的环境特点

## 🛠️ 故障排除

### 常见问题

#### 1. API调用失败
**问题**: 显示"获取实时数据失败"
**解决**:
- 检查API密钥是否正确
- 确认网络连接正常
- 检查API配额是否用完

#### 2. 数据不更新
**问题**: 数据显示过时
**解决**:
- 点击"🔄 刷新"按钮手动更新
- 检查浏览器控制台是否有错误信息
- 确认API服务是否正常

#### 3. 显示模拟数据
**问题**: 想要真实数据但显示的是模拟数据
**解决**:
- 确认已正确配置API密钥
- 检查环境变量文件(.env)是否存在
- 重启开发服务器

## 📱 使用示例

### 查看实时数据
1. 打开仪表盘页面
2. 等待数据加载完成
3. 查看右上角的"🟢 最后更新"时间

### 筛选特定区域
1. 使用省市区三级联动筛选器
2. 选择感兴趣的地区
3. 查看该地区的实时环境数据

### 导出数据
1. 筛选所需数据
2. 点击"📥 导出"按钮
3. 获得包含实时数据的CSV文件

## 🔐 安全注意事项

### API密钥保护
- ❌ **不要**将API密钥提交到版本控制
- ✅ **使用**环境变量存储敏感信息
- ✅ **添加**`.env`到`.gitignore`文件

### 使用限制
- 📊 监控API调用频率
- 💰 注意免费版的调用限制
- 🔄 合理设置刷新间隔

## 📞 技术支持

如果遇到问题：
1. 查看浏览器控制台的错误信息
2. 检查网络连接和API服务状态
3. 确认API密钥配置正确

## 🎉 恭喜！

您的智慧城市环境监测平台现在已经具备真实的实时数据能力！无论是否配置API密钥，系统都能为您提供准确、实时的环境监测数据。

**立即体验**: 打开仪表盘，查看来自全国20+城市的实时环境数据！
