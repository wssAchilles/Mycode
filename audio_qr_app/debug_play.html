<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‚æ•°è°ƒè¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .debug-info {
            background: #f5f5f5;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #007cff;
        }
        .error {
            background: #ffe6e6;
            border-left-color: #ff4444;
        }
        .success {
            background: #e6ffe6;
            border-left-color: #00aa00;
        }
        pre {
            background: #f8f8f8;
            padding: 10px;
            overflow-x: auto;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>ğŸ” URLå‚æ•°è°ƒè¯•å·¥å…·</h1>
    
    <div class="debug-info">
        <h3>å½“å‰URLä¿¡æ¯ï¼š</h3>
        <p><strong>å®Œæ•´URLï¼š</strong> <span id="fullUrl"></span></p>
        <p><strong>æŸ¥è¯¢å‚æ•°ï¼š</strong> <span id="queryParams"></span></p>
        <p><strong>Fragmentï¼š</strong> <span id="fragmentPart"></span></p>
    </div>
    
    <div id="parseResults"></div>
    
    <script>
        // æ˜¾ç¤ºURLä¿¡æ¯
        document.getElementById('fullUrl').textContent = window.location.href;
        document.getElementById('queryParams').textContent = window.location.search;
        document.getElementById('fragmentPart').textContent = window.location.hash;
        
        // å‚æ•°è§£ææµ‹è¯•
        function testParseParams() {
            const results = document.getElementById('parseResults');
            results.innerHTML = '';
            
            const urlParams = new URLSearchParams(window.location.search);
            
            // æµ‹è¯•Fragmentè§£æ
            const fragment = window.location.hash.substring(1);
            if (fragment) {
                const fragDiv = document.createElement('div');
                fragDiv.className = 'debug-info';
                fragDiv.innerHTML = '<h3>Fragmentè§£ææµ‹è¯•ï¼š</h3>';
                
                try {
                    fragDiv.innerHTML += `<p><strong>åŸå§‹Fragmentï¼š</strong> ${fragment.substring(0, 100)}...</p>`;
                    
                    const jsonString = atob(fragment);
                    fragDiv.innerHTML += `<p><strong>Base64è§£ç ç»“æœï¼š</strong></p><pre>${jsonString}</pre>`;
                    
                    const params = JSON.parse(jsonString);
                    fragDiv.innerHTML += `<p><strong>JSONè§£æç»“æœï¼š</strong></p><pre>${JSON.stringify(params, null, 2)}</pre>`;
                    
                    if (params.s && params.n) {
                        fragDiv.className = 'debug-info success';
                        fragDiv.innerHTML += `<p><strong>âœ… è§£ææˆåŠŸï¼</strong></p>`;
                        fragDiv.innerHTML += `<p>æ–‡ä»¶å: ${params.n}</p>`;
                        fragDiv.innerHTML += `<p>éŸ³é¢‘URL: ${params.s}</p>`;
                    } else {
                        fragDiv.className = 'debug-info error';
                        fragDiv.innerHTML += `<p><strong>âŒ ç¼ºå°‘å¿…è¦å‚æ•° (s æˆ– n)</strong></p>`;
                    }
                } catch (e) {
                    fragDiv.className = 'debug-info error';
                    fragDiv.innerHTML += `<p><strong>âŒ è§£æå¤±è´¥ï¼š</strong> ${e.message}</p>`;
                }
                
                results.appendChild(fragDiv);
            }
            
            // æµ‹è¯•å…¶ä»–å‚æ•°
            const otherDiv = document.createElement('div');
            otherDiv.className = 'debug-info';
            otherDiv.innerHTML = '<h3>å…¶ä»–å‚æ•°æµ‹è¯•ï¼š</h3>';
            
            // æµ‹è¯•tokenå‚æ•°
            const token = urlParams.get('token');
            if (token) {
                try {
                    const tokenData = JSON.parse(atob(token));
                    otherDiv.innerHTML += `<p><strong>Tokenå‚æ•°ï¼š</strong> ${JSON.stringify(tokenData)}</p>`;
                } catch (e) {
                    otherDiv.innerHTML += `<p><strong>Tokenè§£æå¤±è´¥ï¼š</strong> ${e.message}</p>`;
                }
            }
            
            // æµ‹è¯•contentå’Œmediaå‚æ•°
            const content = urlParams.get('content');
            const media = urlParams.get('media');
            if (content && media) {
                try {
                    const filename = atob(content);
                    const audioUrl = atob(media);
                    otherDiv.innerHTML += `<p><strong>åˆ†ç¦»å‚æ•°ï¼š</strong> ${filename} | ${audioUrl}</p>`;
                } catch (e) {
                    otherDiv.innerHTML += `<p><strong>åˆ†ç¦»å‚æ•°è§£æå¤±è´¥ï¼š</strong> ${e.message}</p>`;
                }
            }
            
            // æ˜¾ç¤ºæ‰€æœ‰æŸ¥è¯¢å‚æ•°
            otherDiv.innerHTML += '<p><strong>æ‰€æœ‰æŸ¥è¯¢å‚æ•°ï¼š</strong></p><ul>';
            for (const [key, value] of urlParams.entries()) {
                otherDiv.innerHTML += `<li>${key}: ${value}</li>`;
            }
            otherDiv.innerHTML += '</ul>';
            
            results.appendChild(otherDiv);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œæµ‹è¯•
        window.addEventListener('load', testParseParams);
    </script>
</body>
</html>
