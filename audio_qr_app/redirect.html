<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³é¢‘æ’­æ”¾å™¨åŠ è½½ä¸­...</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex; align-items: center; justify-content: center;
            min-height: 100vh; margin: 0; color: white; text-align: center;
        }
        .loader { text-align: center; }
        .spinner {
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white;
            border-radius: 50%; width: 40px; height: 40px;
            animation: spin 1s linear infinite; margin: 0 auto 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="loader">
        <div class="spinner"></div>
        <h2>ğŸµ éŸ³é¢‘æ’­æ”¾å™¨</h2>
        <p>æ­£åœ¨åŠ è½½éŸ³é¢‘ä¿¡æ¯...</p>
        <p id="status">åˆå§‹åŒ–ä¸­</p>
    </div>

    <script>
        const statusEl = document.getElementById('status');
        
        function updateStatus(message) {
            statusEl.textContent = message;
            console.log('çŠ¶æ€:', message);
        }
        
        // é¡µé¢åŠ è½½æ—¶ç«‹å³æ‰§è¡Œ
        (function() {
            updateStatus('è§£æURLå‚æ•°...');
            
            try {
                // è·å–URLå‚æ•°
                const urlParams = new URLSearchParams(window.location.search);
                const dataParam = urlParams.get('data');
                
                if (dataParam) {
                    updateStatus('æ‰¾åˆ°éŸ³é¢‘å‚æ•°ï¼Œä¿å­˜ä¸­...');
                    
                    // è§£æå‚æ•°
                    const jsonString = atob(dataParam);
                    const params = JSON.parse(jsonString);
                    
                    // ä¿å­˜åˆ°localStorage
                    const audioData = {
                        title: params.title || params.f || params.n || 'éŸ³é¢‘æ–‡ä»¶',
                        src: params.src || params.u || params.source,
                        timestamp: Date.now()
                    };
                    
                    localStorage.setItem('tempAudioData', JSON.stringify(audioData));
                    updateStatus('å‚æ•°å·²ä¿å­˜ï¼Œè·³è½¬åˆ°æ’­æ”¾å™¨...');
                    
                    console.log('ä¿å­˜çš„éŸ³é¢‘æ•°æ®:', audioData);
                    
                    // 1ç§’åè·³è½¬åˆ°åœ¨çº¿ç‰ˆæœ¬çš„play.html
                    setTimeout(() => {
                        const onlinePlayUrl = 'https://my-audio-files-123-1380453532.cos-website.ap-nanjing.myqcloud.com/play.html';
                        window.location.href = onlinePlayUrl;
                    }, 1000);
                    
                } else {
                    updateStatus('æœªæ‰¾åˆ°éŸ³é¢‘å‚æ•°');
                    // ç›´æ¥è·³è½¬åˆ°åœ¨çº¿ç‰ˆæœ¬çš„play.html
                    setTimeout(() => {
                        const onlinePlayUrl = 'https://my-audio-files-123-1380453532.cos-website.ap-nanjing.myqcloud.com/play.html';
                        window.location.href = onlinePlayUrl;
                    }, 2000);
                }
                
            } catch (e) {
                updateStatus('å‚æ•°è§£æå¤±è´¥: ' + e.message);
                console.error('å‚æ•°è§£æé”™è¯¯:', e);
                
                // å‡ºé”™æ—¶ä¹Ÿè·³è½¬åˆ°åœ¨çº¿ç‰ˆæœ¬çš„play.html
                setTimeout(() => {
                    const onlinePlayUrl = 'https://my-audio-files-123-1380453532.cos-website.ap-nanjing.myqcloud.com/play.html';
                    window.location.href = onlinePlayUrl;
                }, 2000);
            }
        })();
    </script>
</body>
</html>
