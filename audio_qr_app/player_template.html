<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no,address=no,email=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <meta property="og:title" content="{{AUDIO_TITLE}} - éŸ³é¢‘æ’­æ”¾å™¨">
    <meta property="og:description" content="é«˜å“è´¨éŸ³é¢‘åœ¨çº¿æ’­æ”¾">
    <meta property="og:type" content="website">
    <meta name="description" content="ä¸“ä¸šéŸ³é¢‘æ’­æ”¾å™¨ï¼Œæ”¯æŒå¤šç§æ ¼å¼">
    <title>{{AUDIO_TITLE}} - éŸ³é¢‘æ’­æ”¾å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            line-height: 1.6;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 30px 25px;
            max-width: 420px;
            width: 100%;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }
        
        .title {
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 25px;
        }
        
        .filename {
            color: #34495e;
            margin-bottom: 25px;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            word-break: break-all;
            font-size: 16px;
            font-weight: 500;
            border-left: 4px solid #667eea;
        }
        
        .audio-container {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px dashed #dee2e6;
        }
        
        .audio-player {
            width: 100%;
            border-radius: 12px;
            outline: none;
        }
        
        .button-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            padding: 14px 24px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            min-width: 120px;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.6);
        }
        
        .tips {
            margin-top: 20px;
            color: #6c757d;
            font-size: 14px;
            line-height: 1.8;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 3px solid #17a2b8;
        }
        
        .loading {
            display: none;
            color: #6c757d;
            font-size: 16px;
            margin: 20px 0;
        }
        
        .error {
            display: none;
            color: #dc3545;
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-size: 14px;
        }
        
        .success {
            display: none;
            color: #155724;
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-size: 14px;
        }
        
        .info {
            margin-top: 20px;
            color: #495057;
            font-size: 13px;
            line-height: 1.6;
            padding: 15px;
            background: #e9ecef;
            border-radius: 10px;
            border-left: 3px solid #6c757d;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 480px) {
            .container {
                padding: 25px 20px;
                margin: 10px;
            }
            
            .title {
                font-size: 24px;
            }
            
            .filename {
                font-size: 14px;
                padding: 12px;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 14px;
                min-width: 100px;
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">ğŸµ</h1>
        <p class="subtitle">éŸ³é¢‘æ’­æ”¾å™¨</p>
        
        <div class="filename" id="filename">{{AUDIO_TITLE}}</div>
        
        <div class="loading" id="loading">æ­£åœ¨åŠ è½½éŸ³é¢‘æ–‡ä»¶...</div>
        <div class="error" id="errorMessage"></div>
        <div class="success" id="successMessage"></div>
        
        <div class="audio-container" id="audioContainer">
            <audio class="audio-player" id="audioPlayer" controls preload="auto">
                æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾åŠŸèƒ½ã€‚è¯·å°è¯•æ›´æ–°æµè§ˆå™¨æˆ–ä½¿ç”¨å…¶ä»–æµè§ˆå™¨ã€‚
            </audio>
        </div>
        
        <div class="button-group" id="buttonGroup">
            <button class="btn btn-primary" id="playBtn" onclick="togglePlay()">
                <span id="playIcon">â–¶ï¸</span>
                <span id="playText">æ’­æ”¾</span>
            </button>
            <a href="{{AUDIO_URL}}" class="btn btn-secondary" id="downloadBtn" target="_blank" download="{{AUDIO_TITLE}}">
                ğŸ“¥ ä¸‹è½½éŸ³é¢‘
            </a>
        </div>
        
        <div class="tips">
            ğŸ’¡ <strong>ä½¿ç”¨æç¤ºï¼š</strong><br>
            â€¢ ç‚¹å‡»æ’­æ”¾æŒ‰é’®å¼€å§‹æ’­æ”¾éŸ³é¢‘<br>
            â€¢ æ”¯æŒæµè§ˆå™¨å†…ç›´æ¥æ’­æ”¾å’Œä¸‹è½½<br>
            â€¢ å¯ä»¥ä¿å­˜æ­¤é¡µé¢ç¦»çº¿æ’­æ”¾
        </div>
        
        <div class="info">
            ğŸ“± <strong>ç¦»çº¿æ’­æ”¾è¯´æ˜ï¼š</strong><br>
            æ­¤é¡µé¢å·²åŒ…å«å®Œæ•´çš„æ’­æ”¾å™¨åŠŸèƒ½ï¼Œå¯ä»¥ä¿å­˜åˆ°æœ¬åœ°ç¦»çº¿ä½¿ç”¨ã€‚<br>
            ç”Ÿæˆæ—¶é—´ï¼š{{GENERATE_TIME}}
        </div>
    </div>
    
    <script>
        // å…¨å±€å˜é‡ - éŸ³é¢‘ä¿¡æ¯ç›´æ¥åµŒå…¥
        const audioInfo = {
            title: '{{AUDIO_TITLE}}',
            url: '{{AUDIO_URL}}',
            generateTime: '{{GENERATE_TIME}}'
        };
        
        let audioPlayer = null;
        let isPlaying = false;
        
        // DOMå…ƒç´ 
        const elements = {
            filename: document.getElementById('filename'),
            loading: document.getElementById('loading'),
            errorMessage: document.getElementById('errorMessage'),
            successMessage: document.getElementById('successMessage'),
            audioContainer: document.getElementById('audioContainer'),
            audioPlayer: document.getElementById('audioPlayer'),
            buttonGroup: document.getElementById('buttonGroup'),
            downloadBtn: document.getElementById('downloadBtn'),
            playBtn: document.getElementById('playBtn'),
            playIcon: document.getElementById('playIcon'),
            playText: document.getElementById('playText')
        };
        
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading() {
            elements.loading.style.display = 'block';
            elements.errorMessage.style.display = 'none';
            elements.successMessage.style.display = 'none';
        }
        
        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            elements.loading.style.display = 'none';
            elements.errorMessage.style.display = 'block';
            elements.errorMessage.textContent = message;
        }
        
        // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
        function showSuccess(message) {
            elements.loading.style.display = 'none';
            elements.successMessage.style.display = 'block';
            elements.successMessage.textContent = message;
            
            setTimeout(() => {
                elements.successMessage.style.display = 'none';
            }, 3000);
        }
        
        // æ’­æ”¾/æš‚åœåˆ‡æ¢
        function togglePlay() {
            if (!audioPlayer) return;
            
            if (isPlaying) {
                audioPlayer.pause();
            } else {
                audioPlayer.play().catch(error => {
                    console.error('æ’­æ”¾å¤±è´¥:', error);
                    showError('æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶æˆ–ç½‘ç»œè¿æ¥');
                });
            }
        }
        
        // æ›´æ–°æ’­æ”¾æŒ‰é’®çŠ¶æ€
        function updatePlayButton(playing) {
            isPlaying = playing;
            elements.playIcon.textContent = playing ? 'â¸ï¸' : 'â–¶ï¸';
            elements.playText.textContent = playing ? 'æš‚åœ' : 'æ’­æ”¾';
        }
        
        // åˆå§‹åŒ–éŸ³é¢‘æ’­æ”¾å™¨
        function initializeAudio() {
            try {
                audioPlayer = elements.audioPlayer;
                
                console.log('åˆå§‹åŒ–éŸ³é¢‘æ’­æ”¾å™¨');
                console.log('éŸ³é¢‘ä¿¡æ¯:', audioInfo);
                
                // è®¾ç½®éŸ³é¢‘æº
                audioPlayer.src = audioInfo.url;
                
                // éŸ³é¢‘äº‹ä»¶ç›‘å¬
                audioPlayer.addEventListener('loadstart', () => {
                    console.log('å¼€å§‹åŠ è½½éŸ³é¢‘');
                    showLoading();
                });
                
                audioPlayer.addEventListener('loadedmetadata', () => {
                    console.log('éŸ³é¢‘å…ƒæ•°æ®åŠ è½½å®Œæˆ');
                    const duration = audioPlayer.duration;
                    if (duration && !isNaN(duration)) {
                        const minutes = Math.floor(duration / 60);
                        const seconds = Math.floor(duration % 60);
                        showSuccess(`éŸ³é¢‘æ—¶é•¿: ${minutes}:${seconds.toString().padStart(2, '0')}`);
                    }
                });
                
                audioPlayer.addEventListener('canplay', () => {
                    console.log('éŸ³é¢‘å¯ä»¥æ’­æ”¾');
                    elements.loading.style.display = 'none';
                });
                
                audioPlayer.addEventListener('play', () => {
                    updatePlayButton(true);
                });
                
                audioPlayer.addEventListener('pause', () => {
                    updatePlayButton(false);
                });
                
                audioPlayer.addEventListener('ended', () => {
                    updatePlayButton(false);
                    showSuccess('æ’­æ”¾å®Œæˆ');
                });
                
                audioPlayer.addEventListener('error', (e) => {
                    const error = audioPlayer.error;
                    let errorMessage = 'éŸ³é¢‘åŠ è½½å¤±è´¥';
                    
                    if (error) {
                        switch (error.code) {
                            case error.MEDIA_ERR_NETWORK:
                                errorMessage = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥';
                                break;
                            case error.MEDIA_ERR_DECODE:
                                errorMessage = 'éŸ³é¢‘è§£ç å¤±è´¥ï¼Œå¯èƒ½æ˜¯æ ¼å¼ä¸æ”¯æŒ';
                                break;
                            case error.MEDIA_ERR_SRC_NOT_SUPPORTED:
                                errorMessage = 'éŸ³é¢‘æ ¼å¼ä¸æ”¯æŒæˆ–æ–‡ä»¶ä¸å­˜åœ¨';
                                break;
                        }
                    }
                    
                    showError(errorMessage);
                });
                
            } catch (error) {
                console.error('åˆå§‹åŒ–éŸ³é¢‘æ’­æ”¾å™¨å¤±è´¥:', error);
                showError('åˆå§‹åŒ–å¤±è´¥: ' + error.message);
            }
        }
        
        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–');
            console.log('éŸ³é¢‘ä¿¡æ¯:', audioInfo);
            
            // æ£€æŸ¥éŸ³é¢‘ä¿¡æ¯æœ‰æ•ˆæ€§
            if (!audioInfo.url) {
                showError('é”™è¯¯ï¼šéŸ³é¢‘URLæ— æ•ˆ');
                return;
            }
            
            // åˆå§‹åŒ–éŸ³é¢‘æ’­æ”¾å™¨
            initializeAudio();
            
            console.log('åˆå§‹åŒ–å®Œæˆ');
        });
        
        // é”™è¯¯å¤„ç†
        window.addEventListener('error', function(e) {
            console.error('é¡µé¢é”™è¯¯:', e);
            showError('é¡µé¢å‘ç”Ÿé”™è¯¯ï¼Œè¯·åˆ·æ–°é‡è¯•');
        });
        
        // ç½‘ç»œçŠ¶æ€ç›‘å¬
        window.addEventListener('online', function() {
            showSuccess('ç½‘ç»œè¿æ¥å·²æ¢å¤');
        });
        
        window.addEventListener('offline', function() {
            showError('ç½‘ç»œè¿æ¥å·²æ–­å¼€ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ');
        });
    </script>
</body>
</html>
